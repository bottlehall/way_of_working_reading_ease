require 'odyssey'
require 'thor'

require_relative '../lib/fog.rb'
require_relative '../lib/fkgl.rb'

class ReadabilityAction < Thor
  desc "index FILES", "Calculate the worst Flesch-Kincaid and Gunning Fog Grade Levels for the supplied files"
  def index(*filepaths)
    if filepaths.count == 0
      print("FK_LEGEND=no docs\nFK_COLOUR=green\nGF_LEGEND=no docs\nGF_COLOUR=green")
      exit
    end

    filepaths.each do |filepath|
      if !File.exist?(filepath)
        print("FK_LEGEND=bad doc\nFK_COLOUR=red\nGF_LEGEND=bad doc\nGF_COLOUR=red")
        exit
      end
    end

    FleschKincaid.new(filepaths)
    GunningFog.new(filepaths)
  end
end

ReadabilityAction.start(ARGV)
